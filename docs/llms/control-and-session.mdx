---
title: Streaming & Sessions
description: Stream control, idle timeout handling, and session continuity.
---

## Streaming

Use `chat_stream(...)` for event iteration and `chat_stream_handle(...)` for control.

- Idle-timeout enforcement is supported via `LLMRequest.stream_idle_timeout_s`
  or `TimeoutPolicy.stream_idle_timeout_s`.
- Streaming provider fallback is supported through `RoutePolicy(provider_order=...)`.
- `cancel()` and `interrupt()` are available on stream handles.
- Stream lifecycle enforces exactly one terminal completion event.

By default, routing stays on the configured default provider.
Add `RoutePolicy(provider_order=(...))` when you want explicit stream fallback.

### Handle Example

```python
from afk.llms import LLMBuilder, LLMRequest, Message

llm = LLMBuilder().provider("anthropic_agent").for_agent_runtime().build()
req = LLMRequest(
    model="claude-3-7-sonnet",
    messages=[Message(role="user", content="stream this")],
)

handle = await llm.chat_stream_handle(req)
async for event in handle.events:
    ...
result = await handle.await_result()
```

## Sessions

Use `start_session(...)` for provider-native continuity where supported.

- Session persistence remains owned by orchestration/storage layers.
- `afk.llms` only transports session/checkpoint tokens.
